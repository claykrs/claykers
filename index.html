<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>clay's shag clicker</title>
  <style>
    #upgrades-container {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 250px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
  </style>
</head>
<body>
  <h1 id="shags">0 shags</h1>
  <h3 id="idle">0 shags/s</h3>
  <button id="getShagged">+0 shags</button>
  
  <script>    
    function format(n) {
      const suffixes = ['', 'K', 'M', 'B', 'T']
      const abs = Math.abs(n)
    
      if (abs >= 1000 && abs < 100000) {
        return n.toLocaleString()
      }
    
      if (abs >= 100000) {
        let i = 0;
        let value = n;
    
        while (Math.abs(value) >= 1000 && i < suffixes.length - 1) {
          value /= 1000;
          i++;
        }
    
        let formatted = value.toFixed(2)
        formatted = formatted.replace(/\.00$/, '')
        formatted = formatted.replace(/(\.\d)0$/, '$1')
    
        return formatted + suffixes[i];
      }
    
      return n.toString();
    }

    
    let shags = 0
    let totalShags = 0
    let shagsPerClick = 1
    let shagsPerSecond = 0

    let upgrades = {
      "maddie robinson": [100, 1, "second", 0]
    }

    const shagsT = document.getElementById("shags")
    const idleT = document.getElementById("idle")        
    const shag = document.getElementById("getShagged")

    const upgradesContainer = document.createElement("div")
    upgradesContainer.id = "upgrades-container"
    document.body.appendChild(upgradesContainer)
            
    shag.onclick = function() {
      shags += shagsPerClick
      totalShags += shagsPerClick
    }
      
    for (let name in upgrades) {
      let price = upgrades[name][0]
      let value = upgrades[name][1]
      let type = upgrades[name][2]
      let button = document.createElement("button")
     
      button.id = name
      button.innerHTML = 
          name + " (0)" +"<br>" + 
          "+" + value + " shags per " + type +
          "<br>" + "-" + price + " shags";
      upgradesContainer.appendChild(button)

      button.onclick = function() {
        if (shags >= price) {
          shags -= price
          upgrades[name][3] += 1

          button.innerHTML = 
            name + " (" + upgrades[name][3] + ")" +"<br>" + 
            "+" + value + " shags per " + type +
            "<br>" + "-" + price + " shags";
          
          if (type == "click") {
            shagsPerClick += value
          } else {
            shagsPerSecond += value
          }
        }        
      }
    }

    setInterval(() => {
      shagsT.textContent = format(shags) + " shags"
      shag.textContent = "[ +" + shagsPerClick + " shags ]"
      
      if (shagsPerSecond > 0) {
        shags += (shagsPerSecond / 100)
      }
    }, 10)
  </script>
</body>
</html>
